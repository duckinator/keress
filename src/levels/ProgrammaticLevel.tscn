[gd_scene load_steps=4 format=2]

[ext_resource path="res://player/Player.tscn" type="PackedScene" id=1]
[ext_resource path="res://mesh_libraries/LevelMeshLibrary.tres" type="MeshLibrary" id=2]

[sub_resource type="GDScript" id=1]

script/source = "extends Spatial

var mobs = []
var grids
func _ready():
	grids = $Grids
	
	var Floor = new_grid(Vector3(0, 0, 0), Vector3(0, 0, 0))
	var Ceil = new_grid(Vector3(0, 50, 0), Vector3(0, 180, 180))
	var Left = new_grid(Vector3(0, 0, -100), Vector3(90, 180, 180))
	var Right = new_grid(Vector3(0, 0, 100), Vector3(-90, 180, 180))
	var Start = new_grid(Vector3(-10, 0, 0), Vector3(-90, 180, 90))
	var End = new_grid(Vector3(400, 0, 0), Vector3(-90, -180, -90))
	
	#for x in range(-10, 10):
	#	for z in range(-10, 10):
	#		# Set the start wall.
	#		Start.set_cell_item(x, 0, z, 0)
	#		# Set the end wall.
	#		End.set_cell_item(x, 0, z, 0)
	
	# `x` = corridor length.
	#for x in range(-2, 200):
	#	for z in range(-10, 10):
	#		# Set the floor.
	#		Floor.set_cell_item(x, 0, z, 1)
	#		# Set the ceiling.
	#		Ceil.set_cell_item(x, 0, z, 1)

	#	for z in range(-10, 10):
	#			# Set the left wall.
	#			Left.set_cell_item(x, 1, z, 0)
	#			# Set the right wall.
	#			Right.set_cell_item(x, 1, z, 0)
	
	for x in range(-2, 10):
		for z in range(-10, 10):
			Floor.set_cell_item(x, 0, z, 1)
	
	add_child(Floor)
	#add_child(Ceil)
	#add_child(Left)
	#add_child(Right)
	#add_child(Start)
	#add_child(End)

#func _process(delta):
#	# Called every frame. Delta is time since last frame.
#	# Update game logic here.
#	pass


func new_grid(translation, rotation):
	var grid = $DummyGridMap.duplicate()
	grid.translation.x = translation.x
	grid.translation.y = translation.y
	grid.translation.z = translation.z
	grid.rotation_degrees.x = rotation.x
	grid.rotation_degrees.y = rotation.x
	grid.rotation_degrees.z = rotation.z
	grid.visible = true
	return grid"

[node name="ProgrammaticLevel" type="Spatial" index="0"]

script = SubResource( 1 )

[node name="WorldEnvironment" type="WorldEnvironment" parent="." index="0"]

environment = null

[node name="Player" parent="." index="1" instance=ExtResource( 1 )]

[node name="Grids" type="Node" parent="." index="2"]

[node name="DummyGridMap" type="GridMap" parent="." index="3"]

visible = false
theme = ExtResource( 2 )
cell_size = Vector3( 10, 2, 10 )
cell_octant_size = 8
cell_center_x = true
cell_center_y = true
cell_center_z = true
cell_scale = 1.0
collision_layer = 1
collision_mask = 1
data = {
"cells": PoolIntArray(  )
}
_sections_unfolded = [ "Cell", "Transform" ]
__meta__ = {
"_editor_clip_": 0
}


